# TUI 使い方

```bash
# pythonで実行
python -m dandori

# uvで実行
uv run dandori

# エイリアス
alias dandori="python -m dandori" # or `alias dandori="uv run dandori"`
dandori
```

## 起動

```bash
dandori tui
```

## 画面構成

- **ヘッダー**: タイトルと現在のフィルタ状態を表示
- **リストビュー（左半分）**: タスク一覧
- **詳細ビュー（右半分）**: 選択中のタスクの詳細情報
- **フッター**: 操作結果やエラーメッセージを表示

## 基本操作

### 終了

- `q` / `Q`: アプリケーションを終了

### カーソル移動

- `↑` / `↓`: タスク一覧で上下に移動
- `Home`: 先頭（ダミー行）に移動
- `End`: 末尾に移動
- `PageUp` / `PageDown`: ページ単位で移動

### 詳細表示のスクロール

- `[`: 詳細表示を上にスクロール（3行）
- `]`: 詳細表示を下にスクロール（3行）

## リストフィルタ

### ステータスフィルタ (`f (forward) / F (reverse)`)

ステータスフィルタを循環切り替え：

- `all` → `pending` → `in_progress` → `done` → `requested` → `all`

`F` の場合は逆順に循環切り替え。

### アーカイブフィルタ (`a`)

アーカイブ状態でフィルタを循環切り替え：

- `active` → `archived` → `all` → `active`

### トポロジカル順フィルタ (`t`)

トポロジカル順 (タスクの依存関係に沿った並べ方で、親→子の順に並べる) でフィルタ:

- `on` → `off`

### リクエストフィルタ (`r`)

`requested` ステータスのタスクのみ表示するフィルタをトグル

- `on` → `off`

#### 準備完了フィルタ (`y`)

準備完了 (親タスクがすべて完了している) のタスクのみ表示するフィルタをトグル

- `on` → `off`

### ボトルネックフィルter (`b`)

ボトルネック (未完了の子タスクを持つ未完了タスク) のタスクのみ表示するフィルタをトグル

- `on` → `off`

### 弱連結成分フィルter (`c`)

弱連結成分 (そのタスクを起点とした依存関係の独立したグループ) のタスクのみ表示するフィルタをトグル

- `on` → `off`

## タスク操作

### タスクの追加

- `A`: 新しいタスクを追加（現在選択中のタスクの子として追加）
- `Enter`: ダミー行（先頭行）で `Enter` を押すとルートタスクを追加

追加ダイアログで入力可能な項目：

- Title（必須）: タスクのタイトルで、必ず入力する。
- Priority (0-9): タスクの優先度で、0-9の整数を入力する。数字が大きいほど優先する。
- Start Date (ISO形式): タスクの開始日で、`YYYY-MM-DDTHH:MM:SS` 形式で入力する。
- Due Date (ISO形式): タスクの期限で、`YYYY-MM-DDTHH:MM:SS` 形式で入力する。
- Tags (カンマ区切り): タスクのタグで、カンマ (,) 区切りで入力する。
- Description: 自由記述欄

### タスクの編集

- `E`: 現在選択中のタスクを編集

編集ダイアログで変更可能な項目：

- Title（必須）: タスクのタイトルで、必ず入力する。
- Priority: タスクの優先度で、0-9の整数を入力する。数字が大きいほど優先する。
- Start Date: タスクの開始日で、`YYYY-MM-DDTHH:MM:SS` 形式で入力する。
- Due Date: タスクの期限で、`YYYY-MM-DDTHH:MM:SS` 形式で入力する。
- Tags: タスクのタグで、カンマ (,) 区切りで入力する。
- Description: 自由記述欄
- Depends on (first 8-chars or full ID, ',' separated): 親タスクのIDで、カンマ (,) 区切りで入力する。
- Children (first 8-chars or full ID, ',' separated): 子タスクのIDで、カンマ (,) 区切りで入力する。

### ステータス変更

- `P`: ステータスを `pending` に変更
- `I`: ステータスを `in_progress` に変更
- `D`: ステータスを `done` に変更

### アーカイブ

- `X`: 現在選択中のタスクを含む連結成分（ツリー）をアーカイブ
- `U`: 現在選択中のタスクを含む連結成分（ツリー）をアーカイブ解除

### リクエスト

- `R`: 現在選択中のタスクを依頼状態にする

リクエストダイアログで入力可能な項目：

- Assignee: 依頼先の担当者名
- Note: メモ

## 表示

### グラフ表示 (`G`)

現在選択中のタスクの依存関係（deps/children）をオーバーレイで表示

- `ESC`: オーバーレイを閉じる

## ダイアログ操作

ダイアログ表示中：

- `Tab` / `↓`: 次のフィールドに移動
- `↑`: 前のフィールドに移動
- `Enter`: 適用してダイアログを閉じる
- `ESC`: キャンセルしてダイアログを閉じる
- `←` / `→`: カーソルを左右に移動
- `Home` / `End`: カーソルを行頭/行末に移動
- `Backspace` / `Delete`: 文字削除
- 通常の文字入力: テキスト入力

## タスク一覧の表示

各タスク行には以下の情報が表示されます：

- **ステータスマーク**:
  - `-` (pending)
  - `I` (in_progress)
  - `D` (done)
  - `R` (requested)
  - `X` (removed)
  - `A` (archived)
- **タスクID**: 先頭8文字
- **タイトル**

色分け：

- **橙色**: ヘッダー行
- **白色**: 待機中 (`pending`)
- **赤色**: 作業中 (`in_progress`)
- **緑色**: 完了済み (`done`)
- **青色**: 依頼済み (`requested`)
- **灰色**: アーカイブ済み

選択中の行は反転表示されます。

## 詳細表示

選択中のタスクの詳細情報を右側に表示：

- ID
- Title
- Status（アーカイブ状態も表示）
- Priority
- Start Date（設定されている場合）
- Due Date（設定されている場合）
- Tags（設定されている場合）
- Depends on（依存しているタスクID）
- Children（子タスクID）
- Description（設定されている場合）

詳細が長い場合は `[` / `]` キーでスクロールできます。
